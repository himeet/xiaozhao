# 目录

[TOC]

# 内容

### 1. 谈谈64位操作系统和32位操作系统的区别

操作系统只是硬件和应用软件中间的一个平台。32位操作系统针对32位的CPU设计，64位操作系统针对64位CPU设计。

### 2. 谈谈CentOS和Linux的关系

CentOS是Linux众多的发行版本之一。

### 3. 解释一下，Linux下的线程，GDI类



### 4. 进程和线程是什么？进程和线程的区别是什么？

**定义**：**进程是执行着的应用程序，而线程是进程内部的一个执行序列。**

下面是一个生动的例子：

*转载于[https://www.zhihu.com/question/25532384/answer/411179772]*

做个简单的比喻：进程=火车，线程=车厢

- 线程在进程下进行（单纯的车厢无法运行）
- 一个进程可以包含多个线程（一辆火车可以有多个车厢）
- 不同进程间数据很难共享（一辆火车上的乘客很难换到另外一辆火车，比如站点换乘）
- 同一进程下不同线程间数据很易共享（A车厢换到B车厢很容易）
- 进程要比线程消耗更多的计算机资源（采用多列火车相比多个车厢更耗资源）
- 进程间不会相互影响，一个线程挂掉很可能将导致整个进程挂掉（一列火车不会影响到另外一列火车，但是如果一列火车上中间的一节车厢着火了，将影响到所有车厢）
- 进程可以拓展到多机；线程最多扩展到多核CPU，而不能扩展到多机（不同火车可以开在多个轨道上，同一火车的车厢不能在行进的不同的轨道上）*进程的地址空间之间相互独立，同一进程的各线程间共享进程的资源，某进程内的线程对其他进程不可见。*
- 进程使用的内存地址可以上锁，即一个线程使用某些共享内存时，其他线程必须等它结束，才能使用这一块内存。（比如火车上的洗手间）－"互斥锁"
- 进程使用的内存地址可以限定使用量（比如火车上的餐厅，最多只允许多少人进入，如果满了需要在门口等，等有人出来了才能进去）－“信号量”

### 5. 谈一谈，系统线程数量上限是什么？

Linux 系统中单个进程的最大线程数有其最大的限制 PTHREAD_THREADS_MAX。

这个限制可以在/usr/include/bits/local_lim.h中查看 ，对 linuxthreads 这个值一般是 1024，对于 nptl 则没有硬性的限制，仅仅受限于系统的资源。

这个系统的资源主要就是线程的 stack 所占用的内存，用 ulimit -s 可以查看默认的线程栈大小，一般情况下，这个值是8M=8192KB。

### 6. 请问，如何杀死一个进程？

```
kill 进程号
kill -9 进程号  // -9表示强制执行
```

### 7. 请介绍一下，socket编程的三种通信模型，BIO，NIO和AIO

https://blog.csdn.net/weixin_43809223/article/details/100529810

### 8. 你怎么理解操作系统里的内存碎片，有什么解决办法？

内存碎片分为：内部碎片和外部碎片。

内部碎片就是已经被分配出去（能明确指出属于哪个进程）却不能被利用的内存空间；

内部碎片是处于区域内部或页面内部的存储块。占有这些区域或页面的进程并不使用这个存储块。而在进程占有这块存储块时，系统无法利用它。直到进程释放它，或进程结束时，系统才有可能利用这个存储块。

单道连续分配只有内部碎片。多道固定连续分配既有内部碎片，又有外部碎片。

外部碎片指的是还没有被分配出去（不属于任何进程），但由于太小了无法分配给申请内存空间的新进程的内存空闲区域。

外部碎片是出于任何已分配区域或页面外部的空闲存储块。这些存储块的总和可以满足当前申请的长度要求，但是由于它们的地址不连续或其他原因，使得系统无法满足当前申请。

### 9. 介绍一下，什么是页式存储？

主存被等分成大小相等的片，称为主存块，又称为实页。

当一个用户程序装入内存时，以页面为单位进行分配。页面的大小是为2^n ,通常为1KB、2KB、2^n KB等

### 10. 谈一谈，系统如何提高并发性？

1、提高CPU并发计算能力

（1）多进程&多线程

（2）减少进程切换，使用线程，考虑进程绑定CPU

（3）减少使用不必要的锁，考虑无锁编程

（4）考虑进程优先级

（5）关注系统负载

2、改进I/O模型

(1)DMA技术

(2)异步I/O

(3)改进多路I/O就绪通知策略，epoll

(4)Sendfile

(5)内存映射

(6)直接I/O

### 11. 请你解释一下，通常系统CPU比较高是什么原因？

### 12. 死锁（参考《2020王道操作系统》P122）

#### 12.1 死锁的定义

多个进程因**竞争资源**而造成的一种僵局（互相等待），若无外力作用，这些进程都无法向前推进。

#### 12.2 什么情况下会发生死锁/死锁产生的原因

（1）系统资源的竞争

系统中拥有的**不可剥夺资源**，其数量不足以满足多个进程运行的需要，使得进程在运行过程中，会因争夺资源而陷入僵局，如磁带机、打印机等。（只有对不可剥夺资源的竞争才可能产生死锁，对可剥夺资源的竞争是不会引起死锁的）

（2）进程推进顺序非法

进程在运行过程中，请求和释放资源的顺序不当，也同样会引起死锁。

信号量使用不当也会造成死锁。

（3）死锁产生的必要条件

产生死锁必须同时满足以下4个条件，只要其中任意一个条件不成立，死锁就不会发生。

- 互斥条件

  进程要求对所分配的资源（如打印机）进行排他性控制，即在一段时间内某资源仅为一个进程所占有。此时若有其他进程请求该资源，则请求进程只能等待。

- 不剥夺条件

  进程所获得的资源在未使用完之前，不能被其他进程强行夺走，即只能由获得该资源的进程自己来主动释放。

- 请求并保持条件

  进程已经保持了至少一个资源，但又提出了新的资源请求，而该资源已被其他进程占有，此时请求进程被阻塞，但对自己已获得的资源保持不放。

- 循环等待条件

  存在一种进程资源的循环等待链，链中每个进程已获得的资源同时被链中下一个进程所请求。

#### 12.3 解决死锁的策略

（1）死锁预防

（2）避免死锁

（3）死锁的检测及解除

### 13.  Linux如何查询某个进程的CPU占用？

```sh
top -p 666  # 查询PID为666的进程的cpu的占用
```

### 14.  Linux中怎么判断一个文件是文件夹还是文件

使用`ll`命令后，看第一列的内容即可，第一列的第一个字母指明了文件类型：-”表示普通文件，“d”代表目录，“l”代表连接文件，“b”代表设备文件

### 15. 生产者-消费者问题（参考《2020王道-操作系统》P84）

1. 生产者-消费者问题属于**进程同步**问题

2. 问题描述：一组生产者进程和一组消费者进程共享一个初始为空、大小为n的缓冲区，只有缓冲区没满时，生产者才能把消息放入缓冲区，否则必须等待；只有缓冲区不空时，消费者才能从中取出消息，否则必须等待。由于缓冲区是临界资源（*将一次仅允许一个进程使用的资源称为临界资源*），它只允许一个生产者放入消息，或一个消费者从中取出消息。

3. 问题分析：见书本

4. 伪代码

   ```java
   // semaphore为“信号量”的意思
   semaphore mutex = 1;  // 临界区互斥信号量 
   semaphore empty = n;  // 空闲缓冲区 empty用于记录当前缓冲池中的“空”缓冲区数（空代表无数据的缓冲区）
   semaphore full = 0;  // 满缓冲区初始为空 full用于记录当前缓冲池中的“满”缓冲区数（满代表有数据的缓冲区）
   producer () {  // 生产者进程
     while (1) {
       produce an item in nextp;  // 生产数据
       P(empty);  // 获取空缓冲区单元 空缓冲区数-1
       P(mutex);  // 进入临界区 
       add nextp to buffer;  // 将数据放入缓冲区
       V(mutex);  // 离开缓冲区，释放互斥信号量
       V(full);  // 满缓冲区数+1
     }
   }
   
   consumer () {  // 消费者进程
     while (1) {
       P(full);  // 获取满缓冲区单元 满缓冲区数-1
       P(mutex);  // 进入临界区
       remove an item from buffer;  // 从缓冲区中取出数据
       V(mutex);  // 离开临界区，释放互斥信号量
       V(empty);  // 空缓冲区数+1
       consume the item;
     }
   }
   
   ```

   ### 16. 信号量机制是什么？PV操作是什么？

   见《2020王道-操作系统》P80

   P操作：wait(S)，表示进程请求一个资源，可供分配的资源数-1

   V操作：signal(S)，表示进程释放一个资源，可供分配的资源数+1

   ### 17. 读者-写者问题（参考《2020王道-操作系统》P86）

   <font color='red'>TODO</font>

   ### 18. 哲学家进餐问题（参考《2020王道-操作系统》P88）

   <font color='red'>TODO</font>

   ### 19. 吸烟者问题（参考《2020王道-操作系统》P90）

   <font color='red'>TODO</font>

   ### 20. 进程间的通信有哪几种？（参考《2020王道-操作系统》P34）

   - 共享存储（图示见书）
   - 消息传递（图示见书）
   - 管道通信（图示见书）